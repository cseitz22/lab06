---
title: "Lab 06 - Ugly charts and Simpson's paradox"
author: "Cat Seitz"
date: "2/2/23"
output: github_document
---

### Load packages and data

```{r load-packages, message = FALSE}
library(tidyverse) 
library(dsbox)
library(mosaicData) 
library(ggbreak) 
library(patchwork)
```

### Exercise 1

```{r load_data}

staff <- read_csv("data/instructional-staff.csv", show_col_types = FALSE)

```

After pivoting the data, the data frame should be 55 rows. 

```{r pivot_df}

staff_long <- staff %>%
  pivot_longer(-faculty_type, names_to = "year") %>%
  mutate(value=as.numeric(value))
  

```

```{r plot_staff_long}

staff_long %>%
  ggplot(aes(x = year,
             y = value,
             group = faculty_type,
             color = faculty_type)) +
  geom_line()+
  labs(title="Percentage of staff hires by year",
       x="Year",
       y="Percentage of hires (%)")+
  guides(color = guide_legend(title="Faculty Type"))


```



### Exercise 2

In order to show that the proportion of part-time faculty hiring has increased compared to other instructional staff types, I would make a new data frame with the average of the four other staff types and then create the same graph. 

```{r create-new-df}

staff_df <- staff_long %>%
  subset(faculty_type!="Part-Time Faculty")

staff_df<- staff_df %>%
  group_by(year)%>%
  summarise(mean_pct=mean(value),
            faculty_type="other_types")

pt_faculty <- staff_long %>%
  subset(faculty_type=="Part-Time Faculty")

```

```{r new_plot}

ggplot() +
geom_line(data=pt_faculty,aes(x = year,
           y = value,
           group = faculty_type,
           color = faculty_type))+
geom_line(data=staff_df,aes(x = year,
           y = mean_pct,
           group = faculty_type,
           color = faculty_type))+
  labs(title="Percentage of staff hires by year",
       x="Year",
       y="Percentage of hires (%)")+
  guides(color = guide_legend(title="Faculty Type"))

```


### Exercise 3

The goal to improve the fisheries graph is to plot the data with a scale break since it seems like there are only a few countries that capture/farm way more fish than the rest. First, I'm going to filter the data for countries that have a total harvest of over 100,000 tons. After the filter, we now have 82 countries. 

```{r import_fish_data}

fisheries <- read_csv("data/fisheries.csv", show_col_types = FALSE)

```

```{r filter_data}

fisheries <- fisheries%>%
  filter(total>100000)

```

```{r plot}

g <- ggplot(data=fisheries, 
            aes(x=country, y=total))+ #, group=country, color=country
  geom_point()
g2<- g+ scale_y_break(c(2350000,81400000))
g2
```
Since there are still 82 countries that capture/farm over 100,000 fish, our x-axis will always be super jumbled if we keep all 82 countries in one graph. We could (1) raise the bar of how many fish a country needs to capture/farm to get on the graph or (2) break down the graph into a several graphs based on continent. Possibly, putting country on the y-axis would give use more room to see the country. I could also try plotting captured and farmed fish separately. 



### Smokers in Whickham
### Exercise 1

```{r whickham}

data(Whickham)

```

These data come from an observational study because there was no manipulation introduced. The researchers observed individuals age and smoking habits and then observed if they were alive 20 years later. 


### Exercise 2

There are 1314 observations in this dataset with each observation representing a single subject. 


### Exercise 6






### Exercise 7













